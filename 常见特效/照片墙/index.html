<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		ul{
			width: 660px;
			margin: 10px auto;
			position: relative;
		}
		li{
			list-style: none;
			width: 200px;
			height: 150px;
			float: left;
			margin-left: 10px;
			margin-bottom: 10px;
		}
		.active{
			border:1px red solid;
		}
	</style>
	<script>
		window.onload = function(){
			var oUl = document.querySelector("#ul1");
			var oLi = oUl.querySelectorAll("li");
			var i = 0;
			var aPos = [];
			var mInIndex = 1;
			for(i = 0; i < oLi.length; i++){
				aPos[i] = {left:oLi[i].offsetLeft, top: oLi[i].offsetTop};
			}
			//布局转换
			for(i = 0; i <oLi.length; i++){
				oLi[i].style.left = aPos[i].left + "px";
				oLi[i].style.top = aPos[i].top + "px";
				oLi[i].style.position = "absolute";
				oLi[i].style.margin = "0";
			}

			for(i = 0; i < oLi.length; i++){
				setDrag(oLi[i]);
			}
			function setDrag(obj){
				obj.onmousedown = function(ev){
					obj.style.zIndex = mInIndex++;
					ev = ev || window.event;
					var disX = ev.clientX - obj.offsetLeft;
					var disY = ev.clientY - obj.offsetTop;

					document.onmousemove = function(ev){
						ev = ev || window.event;
						obj.style.left = ev.clientX - disX + "px";
						obj.style.top  = ev.clientY - disY + "px";
						for(i = 0; i <oLi.length; i++){
							oLi[i].className = "";
							if(obj == oLi[i]){
								continue;
							}
							if(cdTest(obj, oLi[i])){
								oLi[i].className = "active";
							}
						}
					};
					document.onmouseup = function(){
						document.onmousedown = null;
						document.onmousemove = null;
					}
				return false;
				}
			}

			function cdTest(obj1, obj2){
				var l1 = obj1.offsetLeft;
				var r1 = obj1.offsetLeft + obj1.offsetWidth;
				var t1 = obj1.offsetTop;
				var b1 = obj1.offsetTop + obj1.offsetHeight;

				var l2 = obj2.offsetLeft;
				var r2 = obj2.offsetLeft + obj2.offsetWidth;
				var t2 = obj2.offsetTop;
				var b2 = obj2.offsetTop + obj2.offsetHeight;
				
				if(r1 < l2 || l1 > r2 || t1 > b2 || b1 < t2){
					return false;
				}
				return true;
			}
		}
	</script>
</head>
<body>
	<ul id="ul1">
			<li><img src="images/1.jpg" alt=""></li>
			<li><img src="images/2.jpg" alt=""></li>
			<li><img src="images/3.jpg" alt=""></li>
			<li><img src="images/4.jpg" alt=""></li>
			<li><img src="images/5.jpg" alt=""></li>
			<li><img src="images/1.jpg" alt=""></li>
			<li><img src="images/2.jpg" alt=""></li>
			<li><img src="images/3.jpg" alt=""></li>
			<li><img src="images/4.jpg" alt=""></li>
			<li><img src="images/5.jpg" alt=""></li>
		</ul>	
</body>
</html>