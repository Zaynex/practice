{"version":3,"sources":["H5ComponentRadar.js"],"names":["H5ComponentRadar","name","cfg","component","H5ComponentBase","w","width","h","height","cns","document","createElement","ctx","getContext","append","r","beginPath","arc","Math","PI","stroke","step","data","length","isBlue","s","i","rad","x","sin","y","cos","lineTo","closePath","fillStyle","fill","moveTo","text","$","css","strokeStyle","draw","per","find","clearRect","rate","on","setTimeout","console","log"],"mappings":"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","file":"H5ComponentRadar.js","sourcesContent":["var H5ComponentRadar = function(name, cfg){\r\n  var component = new H5ComponentBase(name, cfg);\r\n\r\n  //绘制网格线，背景层\r\n  var w = cfg.width;\r\n  var h = cfg.height;\r\n\r\n  var cns = document.createElement(\"canvas\");\r\n  var ctx = cns.getContext(\"2d\");\r\n  cns.width = ctx.width = w;\r\n  cns.height = ctx.height = h;\r\n  component.append(cns);\r\n\r\n  var r = w /2;\r\n  ctx.beginPath();\r\n  ctx.arc(r, r, 5, 0, 2*Math.PI);\r\n  ctx.stroke();\r\n\r\n  // ctx.beginPath();\r\n  // ctx.arc(r, r, r-5, 0 ,2*Math.PI);\r\n  // ctx.stroke();\r\n\r\n  var step = cfg.data.length;\r\n  //雷达图\r\n  var isBlue = false;\r\n  for(var s = 10; s > 0; s--){\r\n    ctx.beginPath();\r\n    for(var i = 0; i < step; i++){\r\n      var rad = (2*Math.PI / 360) * (360 / step) * i;\r\n      var x = r + Math.sin(rad) * r * (s/10);\r\n      var y = r + Math.cos(rad) * r * (s/10);\r\n      ctx.lineTo(x, y);\r\n    }\r\n    ctx.closePath();\r\n    ctx.fillStyle = (isBlue = !isBlue) ?'#99c0ff' : '#f1f9ff';//颜色注意不能大写\r\n    ctx.fill();\r\n  }\r\n\r\n  //伞骨图\r\n  for(var i = 0;i<step;i++){\r\n    var  rad = ( 2*Math.PI / 360 ) * ( 360 / step ) * i;\r\n\r\n    var x = r + Math.sin( rad ) * r ;\r\n    var y = r + Math.cos( rad ) * r ;\r\n    ctx.moveTo(r,r);\r\n    ctx.lineTo(x,y);\r\n    //  输出项目文字\r\n    var text = $('<div class=\"text\">');\r\n    text.text( cfg.data[i][0] );\r\n\r\n    if( x > w/2 ){\r\n     text.css('left',x/2+5);\r\n    }else{\r\n     text.css('right',(w-x)/2+5);\r\n    }\r\n\r\n    if( y > h/2){\r\n      text.css('top',y/2+5);\r\n    }else{\r\n      text.css('bottom',(h-y)/2+5);\r\n    }\r\n    if( cfg.data[i][2] ){\r\n      text.css('color',cfg.data[i][2]);\r\n    }\r\n    text.css('opacity',0);\r\n    text.css('transition','all .5s '+ i*.1 + 's');\r\n\r\n    component.append(text);\r\n\r\n  }\r\n  ctx.strokeStyle = '#e0e0e0';\r\n  ctx.stroke();\r\n\r\n\r\n  var cns = document.createElement(\"canvas\");\r\n  var ctx = cns.getContext(\"2d\");\r\n  cns.width = ctx.width = w;\r\n  cns.height = ctx.height = h;\r\n  component.append(cns);\r\n\r\n  var draw = function(per){\r\n    if(per <= 1){\r\n        component.find('.text').css('opacity',0);\r\n    }\r\n    if(per >= 1){\r\n        component.find('.text').css('opacity',1);\r\n    }\r\n    //连线\r\n    ctx.clearRect(0, 0, w ,h);\r\n    for(var i = 0; i < step; i++){\r\n      var rad = (2*Math.PI / 360) * (360 / step) * i;\r\n      var rate = cfg.data[i][1] * per;\r\n      var x = r + Math.sin(rad) * r * rate;\r\n      var y = r + Math.cos(rad) * r * rate;\r\n      \r\n      ctx.lineTo(x, y);\r\n    }\r\n    // ctx.closePath();\r\n    ctx.stroke();\r\n\r\n    //输出数据的点\r\n    ctx.fillStyle = \"#ff7676\";\r\n    for(var i = 0; i < step; i++){\r\n      var rad = (2*Math.PI / 360) * (360 / step) * i;\r\n      var rate = cfg.data[i][1] * per;\r\n      var x = r + Math.sin(rad) * r * rate;\r\n      var y = r + Math.cos(rad) * r * rate;\r\n      \r\n      ctx.beginPath();\r\n      ctx.arc(x, y, 5, 0, 2*Math.PI);\r\n      ctx.fill();//填充颜色\r\n      ctx.closePath();//如果已经闭合，什么也不不做\r\n    }\r\n\r\n  };\r\n\r\n   component.on('onLoad',function(){\r\n    //  雷达图生长动画\r\n      // var s = 0;\r\n      for(i = 0; i <100; i++){\r\n        (function(i){\r\n          setTimeout(function(){\r\n            // s += .01;\r\n            // draw(s);\r\n            draw(i/100 + 0.1);\r\n            console.log(i);\r\n          }, i*10 + 500);\r\n        })(i)\r\n      }\r\n  });\r\n   component.on('onLeave',function(){\r\n    //  雷达图退场动画\r\n      for(i = 0; i < 100; i++){\r\n        (function(i){\r\n          setTimeout(function(){\r\n            draw(1-i/100);\r\n          }, i*10);\r\n        })(i)\r\n      }\r\n  });\r\n\r\n  return component;\r\n}"]}